{% extends layout_path %}

{% load static %}
{% load i18n %}

{% block title %}
  {{ post.title }} - Blog
  {% if seo_meta %}
    <meta name="description" content="{{ seo_meta.meta_description }}">
    <meta name="keywords" content="{{ seo_meta.meta_keywords }}">
  {% else %}
    <meta name="description" content="{{ post.content|truncatechars:250 }}">
    <meta name="keywords" content="{{ post.tags.all|join:', ' }}">
  {% endif %}
{% endblock %}

{% block content %}

  {% if messages %}
    {% for message in messages %}
      <div
        class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'error' %}alert-danger{% else %}alert-danger{% endif %}"
        role="alert">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}

  <hr>

  <section class="section-py first-section-pt">
    <div class="container">
      <div class="row">
        <div class="col-lg-8">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb breadcrumb-style1 mb-2">
              <li class="breadcrumb-item">
                <a href="{% url 'blog_app:post_list' %}"><strong>Blog</strong></a>
              </li>
              <li class="breadcrumb-item active"><strong>{{ post.title }}</strong></li>
            </ol>
          </nav>
          <h4 class="mb-2">{{ post.title }}</h4>
          <p>
            <i class="ti ti-user me-2"></i>
            {{ post.author.username }}
          </p>
          <p>
            <i class="ti ti-calendar me-2"></i>
            {{ post.published_at|date:"F j, Y" }} - Updated {{ post.updated_at|date:"F j, Y" }}
          </p>
          <p>
            <i class="ti ti-tag me-2"></i>
            {% for tag in post.tags.all %}
              <span class="badge bg-primary rounded p-1 m-1">
                <strong>#{{ tag.name }}</strong>
              </span>
            {% endfor %}
          </p>
          <hr class="my-6">
          {% if post.thumbnail_image %}
            <div class="my-6">
              <img src="{{ post.thumbnail_image.url }}" alt="{{ post.title }}"
                   class="img-fluid w-50 rounded float-start m-4">
            </div>
          {% endif %}
          <p style="text-align: justify;">{{ post.content|safe|linebreaksbr }}</p>
          <hr class="my-6">
        </div>
        <div class="col-lg-4">
          <div class="bg-lighter py-2 px-4 rounded">
            <h6 class="mb-0">
              <i class="ti ti-link me-2"></i>
              <strong>Related Posts</strong>
            </h6>
          </div>
          <ul class="list-unstyled mt-4 mb-0">
            {% for related_post in related_posts %}
              <li class="mb-4">
                <a href="{% url 'blog_app:post_detail' slug=related_post.slug %}"
                   class="text-heading d-flex justify-content-between">
                  <span class="text-truncate me-2">{{ related_post.title }}</span>
                  <i class="ti ti-chevron-right scaleX-n1-rtl text-muted"></i>
                </a>
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </section>
{% endblock %}
