<!--
  ~ Copyright (c) 2024 BMD™ Autonomous Holdings. All rights reserved.
  ~
  ~ Project: Bimod.io™
  ~ File: detail_hadron_system.html
  ~ Last Modified: 2024-10-18 00:39:00
  ~ Author: Ege Dogan Dursun (Co-Founder & Chief Executive Officer / CEO @ BMD™ Autonomous Holdings)
  ~ Created: 2024-10-18 00:39:00
  ~
  ~ This software is proprietary and confidential. Unauthorized copying,
  ~ distribution, modification, or use of this software, whether for
  ~ commercial, academic, or any other purpose, is strictly prohibited
  ~ without the prior express written permission of BMD™ Autonomous
  ~ Holdings.
  ~
  ~  For permission inquiries, please contact: admin@Bimod.io.
  ~
  -->

{% extends layout_path %}

{% block title %}Hadron System Details{% endblock %}

{% block content %}
  <div class="row">
    <div class="tips-section alert alert-secondary alert-dismissible d-flex ms-2 col-lg-11 align-items-center"
         role="alert">
      <img src="{% static 'img/custom-illustrations-v2/i2-71.png' %}" width="25%" style="border-radius:25px;"
           class="justify-content-end me-8" alt="Illustration for tip">
      <span class="alert-icon rounded">
        <i class="ti ti-bookmark"></i>
      </span>
      <div class="d-flex flex-column ps-1">
        <h5 class="alert-heading mb-2">Tip</h5>
        <p class="mb-0">
          In this page, you can view the details of the selected Hadron System. You can also view the nodes and
          topics associated with this system. You can create new nodes and topics using the buttons above.
          For more actions, you can use the buttons in the "Actions" column of the tables below. There are
          pagination controls at the bottom of each table to navigate through the pages of nodes and topics.
        </p>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
        </button>
      </div>
    </div>
    {% if messages %}
      {% for message in messages %}
        <div class="alert {% if message.tags == 'success' %}alert-success{% else %}alert-danger{% endif %}">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
    <a href="{% url 'hadron_prime:list_hadron_system' %}">
      <button class="btn btn-secondary mt-4 mb-8">
        <i class="fa fa-dashboard me-4"></i>
        <strong>Manage Hadron Systems</strong>
      </button>
    </a>
    <hr>
    <div class="col-xl mb-6 mt-4">
      <div class="card">
        <div class="card-header justify-content-between align-items-center">
          <h4 class="mb-0"><strong>
            <i class="fa fa-cogs me-4 mt-4"></i>
            System Details
          </strong></h4>
          <h6 class="">
            <strong>
              <i class="fa fa-bookmark me-4 mt-4"></i>
              {{ hadron_system.system_name }}
            </strong>
          </h6>
        </div>
        <hr>
        <div class="card-body mt-4">
          <p><strong>
            <i class="fa fa-building me-4"></i>
            Organization:
          </strong> {{ hadron_system.organization.name }}</p>
          <p><strong>
            <i class="fa fa-book me-4"></i>
            System Description:
          </strong> {{ hadron_system.system_description }}</p>

          <hr class="mt-8">

          <a class="mt-12" href="{% url 'hadron_prime:create_hadron_node' %}">
            <button class="btn btn-success mb-4 mt-4">
              <i class="fa fa-plus me-2"></i><strong>Create New Node</strong>
            </button>
          </a>

          <!-- Node Section -->
          <hr>
          <h5 class="mt-4"><strong>
            <i class="fa fa-cube me-4"></i>
            Nodes in this System
          </strong></h5>
          {% if nodes_page_obj %}
            <table class="table table-striped table-bordered mt-4">
              <img src="{% static 'img/hadron_prime/had-1.png' %}" class="rounded" style="width: 100%;"
                   alt="Illustration for tips">
              <thead>
              <tr>
                <th>Node Name</th>
                <th>Description</th>
                <th>LLM Model</th>
                <th style="min-width:110px; max-width: 110px;">Message Memory</th>
                <th style="min-width:110px; max-width: 110px;">SEASE Memory</th>
                <th style="min-width:110px; max-width: 110px;">Publish Memory</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody>
              {% for node in nodes_page_obj %}
                <tr>
                  <td><strong>{{ node.node_name }}</strong></td>
                  <td><p
                    style="min-width:310px; max-width: 310px; min-height: 100px; max-height: 100px; overflow: auto;">{{ node.node_description }}</p>
                  </td>
                  <td>
                    {% if node.llm_model %}
                      {{ node.llm_model.nickname }}
                    {% else %}
                      <em>No model assigned</em>
                    {% endif %}
                  </td>
                  <td>
                    <strong>{{ node.topic_messages_history_lookback_memory_size }}</strong>
                  </td>
                  <td>
                    <strong>{{ node.state_action_state_lookback_memory_size }}</strong>
                  </td>
                  <td>
                    <strong>{{ node.publishing_history_lookback_memory_size }}</strong>
                  </td>
                  <td>
                    <a href="{% url 'hadron_prime:detail_hadron_node' node.id %}" class="btn btn-primary btn-sm me-4">
                      <i class="fa fa-eye me-2"></i>
                      <strong>Inspect</strong>
                    </a>
                    <a href="{% url 'hadron_prime:update_hadron_node' node.id %}" class="btn btn-warning btn-sm me-4">
                      <i class="fa fa-edit me-2"></i>
                      <strong>Update</strong>
                    </a>
                    <a href="{% url 'hadron_prime:delete_hadron_node' node.id %}" class="btn btn-danger btn-sm">
                      <i class="fa fa-trash me-2"></i>
                      <strong>Delete</strong>
                    </a>
                  </td>
                </tr>
              {% endfor %}
              </tbody>
            </table>

            <!-- Pagination Controls for Nodes -->
            <nav aria-label="Nodes pagination">
              <ul class="pagination p-4">
                {% if nodes_page_obj.has_previous %}
                  <li class="page-item">
                    <a class="page-link" href="?nodes_page={{ nodes_page_obj.previous_page_number }}"
                       aria-label="Previous">
                      <span aria-hidden="true">&laquo;</span>
                    </a>
                  </li>
                {% endif %}

                {% for num in nodes_page_obj.paginator.page_range %}
                  <li class="page-item {% if nodes_page_obj.number == num %}active{% endif %}">
                    <a class="page-link" href="?nodes_page={{ num }}">{{ num }}</a>
                  </li>
                {% endfor %}

                {% if nodes_page_obj.has_next %}
                  <li class="page-item">
                    <a class="page-link" href="?nodes_page={{ nodes_page_obj.next_page_number }}" aria-label="Next">
                      <span aria-hidden="true">&raquo;</span>
                    </a>
                  </li>
                {% endif %}
              </ul>
            </nav>
          {% else %}
            <p>No nodes available for this system.</p>
          {% endif %}


          <hr class="mt-8">


          <a class="mt-12" href="{% url 'hadron_prime:create_hadron_topic' %}">
            <button class="btn btn-success mb-4 mt-4">
              <i class="fa fa-plus me-2"></i><strong>Create New Topic</strong>
            </button>
          </a>

          <!-- Topic Section -->
          <hr>
          <h5 class="mt-4"><strong>
            <i class="fa fa-bookmark me-4"></i>
            Topics in this System
          </strong></h5>
          {% if topics_page_obj %}
            <table class="table table-striped table-bordered mt-4">
              <img src="{% static 'img/hadron_prime/had-2.png' %}" class="rounded" style="width: 100%;"
                   alt="Illustration for tips">
              <thead>
              <tr>
                <th>Topic Name</th>
                <th>Category</th>
                <th>Purpose</th>
                <th>Created At</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody>
              {% for topic in topics_page_obj %}
                <tr>
                  <td><strong>{{ topic.topic_name }}</strong></td>
                  <td>
                    {% if topic.get_topic_category_display == 'Alerts' %}
                      <span class="btn-danger p-2 rounded"><strong>Alerts</strong></span>
                    {% elif topic.get_topic_category_display == 'Info' %}
                      <span class="btn-warning p-2 rounded"><strong>Info</strong></span>
                    {% elif topic.get_topic_category_display == 'States' %}
                      <span class="btn-primary p-2 rounded"><strong>States</strong></span>
                    {% elif topic.get_topic_category_display == 'Measurements' %}
                      <span class="btn-info p-2 rounded"><strong>Measurements</strong></span>
                    {% elif topic.get_topic_category_display == 'Actions' %}
                      <span class="btn-success p-2 rounded"><strong>Actions</strong></span>
                    {% elif topic.get_topic_category_display == 'Commands' %}
                      <span class="btn-dark p-2 rounded"><strong>Commands</strong></span>
                    {% else %}
                      <span class="btn-secondary p-2 rounded"><strong>Unknown</strong></span>
                    {% endif %}
                  </td>
                  <td><p
                    style="min-width:400px; max-width: 400px; min-height: 100px; max-height: 100px; overflow: auto;">{{ topic.topic_purpose }}</p>
                  </td>
                  <td>{{ topic.created_at|date:"Y-m-d H:i:s" }}</td>
                  <td>
                    <a href="{% url 'hadron_prime:detail_hadron_topic' topic.id %}" class="btn btn-primary btn-sm me-4">
                      <i class="fa fa-eye me-2"></i>
                      <strong>Inspect</strong>
                    </a>
                    <a href="{% url 'hadron_prime:update_hadron_topic' topic.id %}" class="btn btn-warning btn-sm me-4">
                      <i class="fa fa-edit me-2"></i>
                      <strong>Edit</strong>
                    </a>
                    <a href="{% url 'hadron_prime:delete_hadron_topic' topic.id %}" class="btn btn-danger btn-sm">
                      <i class="fa fa-trash me-2"></i>
                      <strong>Delete</strong>
                    </a>
                  </td>
                </tr>
              {% endfor %}
              </tbody>
            </table>

            <!-- Pagination Controls for Topics -->
            <nav aria-label="Topics pagination">
              <ul class="pagination p-4">
                {% if topics_page_obj.has_previous %}
                  <li class="page-item">
                    <a class="page-link" href="?topics_page={{ topics_page_obj.previous_page_number }}"
                       aria-label="Previous">
                      <span aria-hidden="true">&laquo;</span>
                    </a>
                  </li>
                {% endif %}

                {% for num in topics_page_obj.paginator.page_range %}
                  <li class="page-item {% if topics_page_obj.number == num %}active{% endif %}">
                    <a class="page-link" href="?topics_page={{ num }}">{{ num }}</a>
                  </li>
                {% endfor %}

                {% if topics_page_obj.has_next %}
                  <li class="page-item">
                    <a class="page-link" href="?topics_page={{ topics_page_obj.next_page_number }}" aria-label="Next">
                      <span aria-hidden="true">&raquo;</span>
                    </a>
                  </li>
                {% endif %}
              </ul>
            </nav>
          {% else %}
            <p>No topics available for this system.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}
